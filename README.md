![build status](https://github.com/janejuly1/yamdb_final/actions/workflows/yamdb_workflow.yml/badge.svg)

# yamdb_final
yamdb_final

# Где посмотреть
http://178.154.220.70/redoc/

# API для Yatube
### Технологии
Python 3.7
Django 2.2.19
##### ✨ Проект YaMDb
- Проект YaMDb собирает отзывы (Review) пользователей на произведения (Titles). Произведения делятся на категории: «Книги», «Фильмы», «Музыка».
- Сами произведения в YaMDb не хранятся, здесь нельзя посмотреть фильм или послушать музыку.
В каждой категории есть произведения: книги, фильмы или музыка. Например, в категории «Книги» могут быть произведения «Винни-Пух и все-все-все» и «Марсианские хроники», а в категории «Музыка» — песня «Давеча» группы «Насекомые» и вторая сюита Баха.
- Произведению может быть присвоен жанр (Genre) из списка предустановленных (например, «Сказка», «Рок» или «Артхаус»). Новые жанры может создавать только администратор.
- Благодарные или возмущённые пользователи оставляют к произведениям текстовые отзывы (Review) и ставят произведению оценку в диапазоне от одного до десяти (целое число); из пользовательских оценок формируется усреднённая оценка произведения — рейтинг (целое число). На одно произведение пользователь может оставить только один отзыв.
#### Как поднять контейнер:

- Поднять контейнер из директории infra
```
docker-compose up
```
- В контейнере web нужно выполнить миграции, создать суперпользователя и собрать статику. 
```
docker-compose exec web python manage.py migrate
docker-compose exec web python manage.py createsuperuser
docker-compose exec web python manage.py collectstatic --no-input
```
- Остановить контейнеры
```
docker-compose down
```
#### Шаблон наполнения env-файла
```
DB_ENGINE=django.db.backends.postgresql
DB_NAME=postgres
POSTGRES_USER=postgres
POSTGRES_PASSWORD=12356789
DB_HOST=db
DB_PORT=5432
```
#### Наполнение базы данными

- Вы можете наполнить базу вручную, используя функционал сайта, или через панель администратора. А можете перенести данные из локального проекта 
- Для этого копируйте файл dump.json с локального компьютера на сервер.
- Зайдите в директорию с файлом manage.py, экспортируйте данные в файл.
```
python manage.py dumpdata > dump.json
```
- Скопируйте файл dump.json с локального компьютера на сервер. 
```
scp dump.json username@host:/home/имя_пользователя/.../папка_проекта_с_manage.py/ 
```

- Чтобы сделать резервное копирование базы данных:
```
sudo -u postgres pg_dump <name> > <new_name>.dump
```

- Чтобы восстановить данные, нужно создать пустую базу данных (назывите её как-то иначе, нежели основную) и загрузить в неё данные из резервной копии. 
```
sudo -u postgres psql -c 'create database yatube2;' # Создали пустую базу данных с именем yatube2
sudo -u postgres psql -d yatube2 -f yatube_backup.dump # Загрузили в неё данные из дампа 
```
- ✨Magic ✨

# Author
Eugenia Drobova <janejuly1@gmail.com>
